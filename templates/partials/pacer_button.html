{# ABOUTME: HTMX partial for PACER button card in song edit form. #}
{# ABOUTME: button_idx must be set before including this partial. #}
<div class="pacer-button-card border border-gray-200 rounded-lg p-4">
    <div class="flex justify-between items-center mb-2">
        <span class="bg-indigo-600 text-white px-2 py-1 rounded text-sm font-bold">#{{ button_idx + 1 }}</span>
        <button type="button" onclick="this.closest('.pacer-button-card').remove()"
                class="text-red-500 hover:text-red-700">üóëÔ∏è</button>
    </div>
    <div class="mb-4">
        <input type="text" name="button_{{ button_idx }}_name"
               value="{{ button.name if button else '' }}"
               placeholder="Nazwa przycisku" required
               class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500">
    </div>

    <div class="actions-container space-y-2">
        {% if button and button.actions %}
            {% for action in button.actions %}
            {% set action_idx = loop.index0 %}
            {% include "partials/action_row.html" %}
            {% endfor %}
        {% endif %}
    </div>

    <button type="button"
            hx-get="/partials/action-row"
            hx-target="previous .actions-container"
            hx-swap="beforeend"
            hx-vals="js:{button_idx: {{ button_idx }}, action_idx: this.closest('.pacer-button-card').querySelectorAll('.action-row').length}"
            class="mt-2 text-sm text-indigo-600 hover:text-indigo-800">+ Dodaj akcjƒô</button>
</div>
